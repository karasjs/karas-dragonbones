{"version":3,"file":"index.es.js","sources":["src/parser.js","src/util.js","src/render.js","src/index.js"],"sourcesContent":["import karas from 'karas';\n\nconst { inject, math } = karas;\n\nfunction parseAndLoadTex(tex, cb, props = {}) {\n  let src = props.imagePath || tex.imagePath;\n  let texHash = {};\n  inject.measureImg(src, function() {\n    tex.SubTexture.forEach(item => {\n      let { name, x, y, width, height, frameX = 0, frameY = 0, frameWidth = width, frameHeight = height } = item;\n      texHash[name] = {\n        name,\n        x,\n        y,\n        width,\n        height,\n        frameX,\n        frameY,\n        frameWidth,\n        frameHeight,\n        source: inject.IMG[src].source,\n      };\n    });\n    cb(texHash);\n  });\n}\n\nfunction parseSke(ske, texHash, props = {}) {\n  let {\n    frameRate: globalFrameRate,\n    armature,\n  } = ske;\n  let currentArmature = armature[0];\n  if(props.armature) {\n    for(let i = 0, len = armature.length; i < len; i++) {\n      let item = armature[i];\n      if(item.name === props.armature) {\n        currentArmature = item;\n        break;\n      }\n    }\n    if(!currentArmature) {\n      throw new Error('Can not find armature: ' + props.armature);\n    }\n  }\n  if(!currentArmature) {\n    console.warn('No armature data');\n    return;\n  }\n  let {\n    name,\n    bone,\n    slot,\n    skin,\n    frameRate,\n    animation,\n    defaultActions,\n    canvas,\n  } = currentArmature;\n  let boneHash = parseBone(bone);\n  let slotHash = parseSlot(slot);\n  let skinHash = parseSkin(skin, texHash, props);\n  let animationHash = parseAnimation(animation, frameRate || globalFrameRate || 60, boneHash);\n  return {\n    name,\n    bone,\n    boneHash,\n    slot,\n    slotHash,\n    skin: skin[0].slot,\n    skinHash,\n    animationHash,\n    defaultActions,\n    canvas,\n  };\n}\n\nfunction parseSlot(data) {\n  let hash = {};\n  data.forEach(item => {\n    hash[item.name] = item;\n  });\n  return hash;\n}\n\nfunction parseBone(data) {\n  let hash = {};\n  // bone数据形成tree结构，符合dom格式，第一个一定是root\n  let root = data[0];\n  root.children = [];\n  hash[root.name] = root;\n  data.forEach((item, i) => {\n    let { name, parent, transform = {} } = item;\n    if(parent) {\n      hash[parent].children.push(item);\n    }\n    hash[name] = item;\n    item.children = [];\n    item.index = i;\n    // 静态变换样式，可能某个骨骼没动画\n    let matrix = math.matrix.identity();\n    if(transform.x || transform.y) {\n      let m = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, transform.x || 0, transform.y || 0, 0, 1];\n      matrix = math.matrix.multiply(matrix, m);\n    }\n    if(transform.skX) {\n      let d = math.geom.d2r(transform.skX);\n      let sin = Math.sin(d);\n      let cos = Math.cos(d);\n      let m = [cos, sin, 0, 0, -sin, cos, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n      matrix = math.matrix.multiply(matrix, m);\n    }\n    if(transform.scX !== undefined || transform.scY !== undefined) {\n      let m = [transform.scX === undefined ? 1 : transform.scX, 0, 0, 0, 0, transform.scY === undefined ? 1 : transform.scY, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n      matrix = karas.math.matrix.multiply(matrix, m);\n    }\n    item.matrix = matrix;\n  });\n  return hash;\n}\n\nfunction parseSkin(data, texHash, props) {\n  let hash = {};\n  data[0].slot.forEach(item => {\n    let { name: slotName, display } = item;\n    hash[slotName] = item;\n    display.forEach(item => {\n      let { type, name, path } = item;\n      // mesh网格分析三角形\n      if(type === 'mesh') {\n        let { vertices, triangles, uvs, weights, bonePose } = item;\n        let weightHash;\n        let bonePoseHash;\n        // 有权重则绑定骨骼，坐标系为世界；\n        // 没有权重时，完全属于父骨骼，类似普通贴图行为\n        if(weights) {\n          // 权重格式化hash\n          weightHash = {};\n          for(let i = 0, len = weights.length, verticesIndex = 0; i < len; i++) {\n            let num = weights[i];\n            let list = [];\n            for(let j = i + 1; j < i + 1 + num * 2; j += 2) {\n              let index = weights[j];\n              let value = weights[j + 1];\n              list.push({\n                index,\n                value,\n              });\n            }\n            weightHash[verticesIndex++] = list;\n            i += num * 2;\n          }\n          // 骨骼初始pose格式化和世界坐标\n          bonePoseHash = {};\n          for(let i = 0, len = bonePose.length; i < len; i += 7) {\n            let index = bonePose[i];\n            let m = bonePose.slice(i + 1, i + 7);\n            let matrix = [m[0], m[1], 0, 0, m[2], m[3], 0, 0, 0, 0, 1, 0, m[4], m[5], 0, 1];\n            let coords = math.matrix.calPoint([0, 0], matrix);\n            bonePoseHash[index] = {\n              coords,\n              pose: matrix,\n            };\n          }\n        }\n        // 顶点格式化，相对于骨骼点的x/y位移差值\n        let verticesList = item.verticesList = [];\n        for(let i = 0, len = vertices.length; i < len; i += 2) {\n          let index = i >> 1;\n          let x = vertices[i];\n          let y = vertices[i + 1];\n          let res = {\n            index,\n            x,\n            y,\n          };\n          verticesList.push(res);\n          // 有添加绑定骨骼才有权重\n          if(weightHash) {\n            res.weightList = [];\n            let weight = weightHash[index];\n            weight.forEach(item => {\n              let { index, value } = item;\n              let { coords, pose } = bonePoseHash[index];\n              // 先求骨头的角度，逆向选择至水平后，平移x/y的差值\n              let [x0, y0] = math.matrix.calPoint([0, 0], pose);\n              let [x1, y1] = math.matrix.calPoint([1, 0], pose);\n              let dx = x1 - x0;\n              let dy = y1 - y0;\n              let theta;\n              // 4个象限分开判断\n              if(dx >= 0 && dy >= 0) {\n                theta = -Math.atan(Math.abs(dy / dx));\n              }\n              else if(dx < 0 && dy >= 0) {\n                theta = -Math.PI + Math.atan(Math.abs(dy / dx));\n              }\n              else if(dx < 0 && dy < 0) {\n                theta = Math.PI - Math.atan(Math.abs(dy / dx));\n              }\n              else {\n                theta = Math.atan(Math.abs(dy / dx));\n              }\n              let rotate = [Math.cos(theta), Math.sin(theta), 0, 0, -Math.sin(theta), Math.cos(theta), 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n              let translate = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x - coords[0], y - coords[1], 0, 1];\n              let matrix = math.matrix.multiply(rotate, translate);\n              res.weightList.push({\n                index,\n                value,\n                matrix,\n              });\n            });\n          }\n        }\n        // 三角形，切割图片坐标\n        let tex = texHash[path || name];\n        let { width, height } = tex;\n        let triangleList = item.triangleList = [];\n        for(let i = 0, len = triangles.length; i < len; i += 3) {\n          let i1 = triangles[i];\n          let i2 = triangles[i + 1];\n          let i3 = triangles[i + 2];\n          // uv坐标\n          let p1x = uvs[i1 * 2];\n          let p1y = uvs[i1 * 2 + 1];\n          let p2x = uvs[i2 * 2];\n          let p2y = uvs[i2 * 2 + 1];\n          let p3x = uvs[i3 * 2];\n          let p3y = uvs[i3 * 2 + 1];\n          // uv贴图坐标根据尺寸映射真实坐标\n          let x1 = p1x * width;\n          let y1 = p1y * height;\n          let x2 = p2x * width;\n          let y2 = p2y * height;\n          let x3 = p3x * width;\n          let y3 = p3y * height;\n          // 从内心往外扩展约0.25px，可参数指定\n          let [x0, y0] = math.geom.triangleIncentre(x1, y1, x2, y2, x3, y3);\n          let px = parseFloat(props.enlarge);\n          if(isNaN(px)) {\n            px = 0.25;\n          }\n          // 单独为slot配置的扩展参数\n          if(props.enlargeSlot && props.enlargeSlot.hasOwnProperty(slotName)) {\n            let n = parseFloat(props.enlargeSlot[slotName]);\n            if(isNaN(n)) {\n              n = 0.25;\n            }\n            px = n;\n          }\n          let scale = px ? triangleScale(x0, y0, x1, y1, x2, y2, x3, y3, px) : 1;\n          // 以内心为transformOrigin\n          let m = math.matrix.identity();\n          m[12] = -x0;\n          m[13] = -y0;\n          // 缩放\n          let t = math.matrix.identity();\n          t[0] = t[5] = scale;\n          m = math.matrix.multiply(t, m);\n          // 移动回去\n          t[12] = x0;\n          t[13] = y0;\n          m = math.matrix.multiply(t, m);\n          // 获取扩展后的三角形顶点坐标\n          let [sx1, sy1] = math.matrix.calPoint([x1, y1], m);\n          let [sx2, sy2] = math.matrix.calPoint([x2, y2], m);\n          let [sx3, sy3] = math.matrix.calPoint([x3, y3], m);\n          // 三角形所在矩形距离左上角原点的坐标，以此做img切割最小尺寸化，以及变换原点计算\n          // let [ox, oy, ow, oh] = triangleOriginCoords(sx1, sy1, sx2, sy2, sx3, sy3);\n          triangleList.push({\n            index: Math.round(i / 3),\n            indexList: [i1, i2, i3],\n            // ox,\n            // oy,\n            // ow,\n            // oh,\n            // points: [\n            //   [p1x, p1y],\n            //   [p2x, p2y],\n            //   [p3x, p3y]\n            // ],\n            coords: [\n              [x1, y1],\n              [x2, y2],\n              [x3, y3]\n            ],\n            scale,\n            scaleCoords: [\n              [sx1, sy1],\n              [sx2, sy2],\n              [sx3, sy3]\n            ],\n            width,\n            height,\n          });\n        }\n      }\n    });\n  });\n  return hash;\n}\n\n/**\n * 将三角形从内心缩放指定像素\n * @param x0\n * @param y0\n * @param x1\n * @param y1\n * @param x2\n * @param y2\n * @param x3\n * @param y3\n * @param px 缩放多少像素，可正负\n * @returns {number} 缩放倍数\n */\nfunction triangleScale(x0, y0, x1, y1, x2, y2, x3, y3, px = 0) {\n  // 内心到任意一边的距离\n  let a = y2 - y1;\n  let b = x1 - x2;\n  let c = x2 * y1 - x1 * y2;\n  let d = Math.abs(a * x0 + b * y0 + c) / Math.sqrt(Math.pow(a, 2) + Math.pow(b, 2));\n  return (d + px) / d;\n}\n\n/**\n * 获取三角形所在最小矩形的原点坐标、尺寸\n * @param x1\n * @param y1\n * @param x2\n * @param y2\n * @param x3\n * @param y3\n */\nfunction triangleOriginCoords(x1, y1, x2, y2, x3, y3) {\n  let xMin = x1;\n  let yMin = y1;\n  let xMax = x1;\n  let yMax = y1;\n  xMin = Math.min(xMin, x2);\n  xMin = Math.min(xMin, x3);\n  yMin = Math.min(yMin, y2);\n  yMin = Math.min(yMin, y3);\n  xMax = Math.max(xMax, x2);\n  xMax = Math.max(xMax, x3);\n  yMax = Math.max(yMax, y2);\n  yMax = Math.max(yMax, y3);\n  return [xMin, yMin, xMax - xMin, yMax - yMin];\n}\n\nfunction parseAnimation(data, frameRate, boneHash) {\n  let hash = {};\n  data.forEach(item => {\n    let { duration, playTimes, name, bone = [], slot = [], ffd = [] } = item;\n    hash[name] = item;\n    item.options = {\n      duration: 1000 * duration / frameRate,\n      iterations: playTimes === 0 ? Infinity : playTimes,\n      fill: 'forwards',\n    };\n    // 骨骼动画列表\n    item.boneAnimationList = bone.map(item => {\n      let { name, translateFrame, rotateFrame, scaleFrame } = item;\n      let { transform: originTransform = {} } = boneHash[name];\n      let res = {\n        name,\n        list: [],\n      };\n      if(translateFrame) {\n        let offsetSum = 0;\n        let last;\n        let value = translateFrame.map(frame => {\n          let { duration: d = 1 } = frame;\n          let easingFn = getEasing(frame);\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          let { x = 0, y = 0 } = originTransform;\n          let res = {\n            type: 0,\n            translateX: (frame.x || 0) + x,\n            translateY: (frame.y || 0) + y,\n            offset,\n            easingFn,\n          };\n          if(last) {\n            last.dx = res.translateX - last.translateX;\n            last.dy = res.translateY - last.translateY;\n          }\n          last = res;\n          return res;\n        });\n        res.list.push(value);\n      }\n      if(rotateFrame) {\n        let offsetSum = 0;\n        let last;\n        let value = rotateFrame.map(frame => {\n          let { duration: d = 1 } = frame;\n          let easingFn = getEasing(frame);\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          let { skX = 0 } = originTransform;\n          let res = {\n            type: 1,\n            rotateZ: (frame.rotate || 0) + skX,\n            offset,\n            easingFn,\n          };\n          if(last) {\n            last.dz = res.rotateZ - last.rotateZ;\n          }\n          last = res;\n          return res;\n        });\n        res.list.push(value);\n      }\n      if(scaleFrame) {\n        let offsetSum = 0;\n        let last;\n        let value = scaleFrame.map(frame => {\n          let { duration: d = 1 } = frame;\n          let easingFn = getEasing(frame);\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          let { scX = 1, scY = 1 } = originTransform;\n          let res = {\n            type: 2,\n            scaleX: (frame.x === undefined ? 1 : frame.x) * scX,\n            scaleY: (frame.y === undefined ? 1 : frame.y) * scY,\n            offset,\n            easingFn,\n          };\n          if(last) {\n            last.dx = res.scaleX - last.scaleX;\n            last.dy = res.scaleY - last.scaleY;\n          }\n          last = res;\n          return res;\n        });\n        res.list.push(value);\n      }\n      return res;\n    });\n    // 插槽动画列表\n    item.slotAnimationList = slot.map(item => {\n      let { displayFrame, colorFrame } = item;\n      if(displayFrame) {\n        let offsetSum = 0;\n        displayFrame.forEach(frame => {\n          let { duration: d = 1 } = frame;\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          frame.offset = offset;\n        });\n      }\n      if(colorFrame) {\n        let offsetSum = 0;\n        let last;\n        colorFrame.forEach(frame => {\n          let { duration: d = 1 } = frame;\n          frame.easingFn = getEasing(frame);\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          frame.offset = offset;\n          // 没有value就用默认值\n          if(!frame.value) {\n            frame.value = {\n              aM: 100,\n            };\n          }\n          if(frame.value.aM === undefined) {\n            frame.value.aM = 100;\n          }\n          if(last) {\n            last.da = frame.value.aM - last.value.aM;\n          }\n          last = frame;\n        });\n      }\n      return item;\n    });\n    // 自由变形列表\n    let ffdAnimationHash = item.ffdAnimationHash = {};\n    item.ffdAnimationList = ffd.map(item => {\n      let { name, slot, frame } = item;\n      // db限制了不能出现在名字里\n      ffdAnimationHash[slot + '>' + name] = item;\n      if(frame) {\n        let offsetSum = 0;\n        let last;\n        frame.forEach(frame => {\n          let { vertices, duration: d = 1, offset: os } = frame;\n          frame.easingFn = getEasing(frame);\n          if(vertices) {\n            for(let i = 0; i < os; i++) {\n              vertices.unshift(0);\n            }\n          }\n          let offset = offsetSum / duration;\n          offsetSum += d;\n          frame.offset = offset;\n          // 顶点变形数据vertices都是偏移量，无偏移为空\n          if(last) {\n            let verticesLast = last.vertices;\n            if(verticesLast && vertices) {\n              last.dv = [];\n              for(let i = 0, len = Math.max(verticesLast.length, vertices.length); i < len; i++) {\n                last.dv.push((vertices[i] || 0) - (verticesLast[i] || 0));\n              }\n            }\n            else if(verticesLast) {\n              last.dv = last.vertices.map(n => -n);\n            }\n            else if(vertices) {\n              last.dv = vertices;\n            }\n          }\n          last = frame;\n        });\n      }\n      return item;\n    });\n  });\n  return hash;\n}\n\nfunction getEasing(frame) {\n  let curve = frame.curve;\n  if(curve && curve[0] !== 1 && curve[1] !== 1 && curve[2] !== 0 && curve[3] !== 0) {\n    return karas.animate.easing.cubicBezier(curve[0], curve[1], curve[2], curve[3]);\n  }\n}\n\nexport default {\n  parseAndLoadTex,\n  parseSke,\n};\n","import karas from 'karas';\n\nconst { math } = karas;\n\n/**\n * 根据动画时间状态修改骨骼当前matrix\n * @param animationList 动画列表\n * @param offset 当前时间偏移量\n * @param boneHash 骨骼hash\n */\nfunction animateBoneMatrix(animationList, offset, boneHash) {\n  animationList.forEach(item => {\n    let { name, list } = item;\n    let bone = boneHash[name];\n    // 先以静态变换样式为基础\n    let { transform = {} } = bone;\n    let res = {};\n    res.translateX = transform.x || 0;\n    res.translateY = transform.y || 0;\n    res.rotateZ = transform.skX || 0;\n    res.scaleX = transform.scX === undefined ? 1 : transform.scX;\n    res.scaleY = transform.scY === undefined ? 1 : transform.scY;\n    // 再assign动画中的变换样式\n    list.forEach(frames => {\n      let len = frames.length;\n      if(!len) {\n        return;\n      }\n      let type = frames[0].type;\n      let i = binarySearch(0, len - 1, offset, frames);\n      let current = frames[i];\n      let easingFn = current.easingFn;\n      // 是否最后一帧\n      if(i === len - 1) {\n        if(type === 0) {\n          res.translateX = current.translateX;\n          res.translateY = current.translateY;\n        }\n        else if(type === 1) {\n          res.rotateZ = current.rotateZ;\n        }\n        else if(type === 2) {\n          res.scaleX = current.scaleX;\n          res.scaleY = current.scaleY;\n        }\n      }\n      else {\n        let next = frames[i + 1];\n        let total = next.offset - current.offset;\n        let percent = (offset - current.offset) / total;\n        if(easingFn) {\n          percent = easingFn(percent);\n        }\n        if(type === 0) {\n          res.translateX = current.translateX + current.dx * percent;\n          res.translateY = current.translateY + current.dy * percent;\n        }\n        else if(type === 1) {\n          res.rotateZ = current.rotateZ + current.dz * percent;\n        }\n        else if(type === 2) {\n          res.scaleX = current.scaleX + current.dx * percent;\n          res.scaleY = current.scaleY + current.dy * percent;\n        }\n      }\n    });\n    let matrix = math.matrix.identity();\n    if(res.translateX || res.translateY) {\n      let m = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, res.translateX || 0, res.translateY || 0, 0, 1];\n      matrix = math.matrix.multiply(matrix, m);\n    }\n    if(res.rotateZ) {\n      let d = math.geom.d2r(res.rotateZ);\n      let sin = Math.sin(d);\n      let cos = Math.cos(d);\n      let m = [cos, sin, 0, 0, -sin, cos, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n      matrix = math.matrix.multiply(matrix, m);\n    }\n    if(res.scaleX !== undefined || res.scaleY !== undefined) {\n      let m = [res.scaleX === undefined ? 1 : res.scaleX, 0, 0, 0, 0, res.scaleY === undefined ? 1 : res.scaleY, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n      matrix = math.matrix.multiply(matrix, m);\n    }\n    bone.matrixA = matrix;\n  });\n}\n\n/**\n * 二分查找根据时间轴帧序列和当前百分比获得当前帧\n * @param i\n * @param j\n * @param offset\n * @param frames\n * @returns {frame}\n */\nfunction binarySearch(i, j, offset, frames) {\n  if(i === j) {\n    let frame = frames[i];\n    if(frame.offset > offset) {\n      return i - 1;\n    }\n    return i;\n  }\n  else {\n    let middle = i + ((j - i) >> 1);\n    let frame = frames[middle];\n    if(frame.offset === offset) {\n      return middle;\n    }\n    else if(frame.offset > offset) {\n      return binarySearch(i, Math.max(middle - 1, i), offset, frames);\n    }\n    else {\n      return binarySearch(Math.min(middle + 1, j), j, offset, frames);\n    }\n  }\n}\n\n/**\n * 递归遍历骨骼，根据父子属性合并生成骨骼相对于舞台的最终currentMatrix\n * @param root 根骨骼\n */\nfunction mergeBoneMatrix(root) {\n  root.currentMatrix = root.matrixA || root.matrix;\n  root.children.forEach(item => {\n    mergeChildBoneMatrix(item, root.currentMatrix);\n  });\n}\n\nfunction mergeChildBoneMatrix(bone, parentMatrix) {\n  bone.currentMatrix = math.matrix.multiply(parentMatrix, bone.matrixA || bone.matrix);\n  bone.children.forEach(item => {\n    mergeChildBoneMatrix(item, bone.currentMatrix);\n  });\n}\n\n/**\n * 根据当前动画时间执行slot的动画，确定显示slot下的皮肤索引和透明度\n * @param slotAnimationList\n * @param offset\n * @param slotHash\n */\nfunction animateSlot(slotAnimationList, offset, slotHash) {\n  slotAnimationList.forEach(item => {\n    let { name, displayFrame, colorFrame } = item;\n    let slot = slotHash[name];\n    if(displayFrame) {\n      if(displayFrame.length) {\n        let i = binarySearch(0, displayFrame.length - 1, offset, displayFrame);\n        let { value = 0 } = displayFrame[i];\n        slot.displayIndexA = value;\n      }\n    }\n    if(colorFrame) {\n      let len = colorFrame.length;\n      if(len) {\n        let i = binarySearch(0, len - 1, offset, colorFrame);\n        let current = colorFrame[i];\n        let easingFn = current.easing;\n        // 是否最后一帧\n        if(i === len - 1) {\n          slot.colorA = current.value;\n        }\n        else {\n          let next = colorFrame[i + 1];\n          let total = next.offset - current.offset;\n          let percent = (offset - current.offset) / total;\n          if(easingFn) {\n            percent = easingFn(percent);\n          }\n          slot.colorA = {\n            aM: current.value.aM + current.da * percent,\n          };\n        }\n      }\n    }\n  });\n}\n\n/**\n * 根据当前骨骼状态计算slot中显示对象变换matrix\n * @param offset\n * @param slot\n * @param skinHash\n * @param bone\n * @param boneHash\n * @param texHash\n * @param ffdAnimationHash\n */\nfunction calSlot(offset, slot, skinHash, bone, boneHash, texHash, ffdAnimationHash) {\n  slot.forEach(item => {\n    let { name, parent, displayIndex = 0, displayIndexA = displayIndex } = item;\n    // 插槽隐藏不显示\n    if(displayIndexA < 0) {\n      return;\n    }\n    let skin = skinHash[name];\n    let displayTarget = skin.display[displayIndexA];\n    // 网格类型\n    if(displayTarget.type === 'mesh') {\n      let { verticesList, triangleList } = displayTarget;\n      // 先进行顶点变换\n      verticesList.forEach(item => {\n        let { weightList } = item;\n        // 有绑定骨骼的mesh，计算权重\n        if(weightList) {\n          let m = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n          weightList.forEach(weight => {\n            let { index, value, matrix } = weight;\n            let boneMatrix = bone[index].currentMatrix;\n            let offset = karas.math.matrix.multiply(boneMatrix, matrix);\n            for(let i = 0; i < 16; i++) {\n              m[i] += offset[i] * value;\n            }\n          });\n          item.matrix = m;\n        }\n        // 没有绑定认为直属父骨骼\n        else {\n          let parentBoneMatrix = boneHash[parent].currentMatrix;\n          let offsetMatrix = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, item.x, item.y, 0, 1];\n          let m = karas.math.matrix.multiply(parentBoneMatrix, offsetMatrix);\n          item.matrix = m;\n        }\n        // 每次先清空ffd自由变换的数据\n        item.matrixF = null;\n      });\n      // 如果有ffd自定义顶点变换，计算偏移量matrix\n      let ffd = ffdAnimationHash[name + '>' + (displayTarget.path || displayTarget.name)];\n      if(ffd) {\n        let { frame } = ffd;\n        if(frame) {\n          let len = frame.length;\n          let i = binarySearch(0, len - 1, offset, frame);\n          let current = frame[i];\n          let easingFn = current.easingFn;\n          // 是否最后一帧\n          if(i === len - 1) {\n            let { vertices } = current;\n            if(vertices) {\n              for(let i = 0, len = vertices.length; i < len - 1; i += 2) {\n                let x = vertices[i];\n                let y = vertices[i + 1];\n                if(x === 0 && y === 0) {\n                  continue;\n                }\n                let index = i >> 1;\n                let target = verticesList[index];\n                let m = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, 0, 1];\n                target.matrixF = math.matrix.multiply(target.matrix, m);\n              }\n            }\n          }\n          else {\n            let next = frame[i + 1];\n            let total = next.offset - current.offset;\n            let percent = (offset - current.offset) / total;\n            if(easingFn) {\n              percent = easingFn(percent);\n            }\n            let { vertices, dv } = current;\n            if(vertices || dv) {\n              let len = 0;\n              if(vertices) {\n                len = vertices.length;\n              }\n              if(dv) {\n                len = Math.max(len, dv.length);\n              }\n              for(let i = 0; i < len - 1; i += 2) {\n                let x, y;\n                if(vertices) {\n                  x = vertices[i] || 0;\n                  y = vertices[i + 1] || 0;\n                }\n                else {\n                  x = y = 0;\n                }\n                if(dv) {\n                  x += (dv[i] || 0) * percent;\n                  y += (dv[i + 1] || 0) * percent;\n                }\n                if(x === 0 && y === 0) {\n                  continue;\n                }\n                let index = i >> 1;\n                let target = verticesList[index];\n                let m = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, 0, 1];\n                target.matrixF = math.matrix.multiply(target.matrix, m);\n              }\n            }\n          }\n        }\n      }\n      // 三角形根据顶点坐标变化计算仿射变换matrix\n      triangleList.forEach(item => {\n        let { indexList, coords } = item;\n        let source = coords[0].concat(coords[1]).concat(coords[2]);\n        let target = [];\n        indexList.forEach(i => {\n          let vertices = verticesList[i];\n          let coords = math.matrix.calPoint([0, 0], vertices.matrixF || vertices.matrix);\n          target = target.concat(coords.slice(0, 2));\n        });\n        // 先交换确保3个点顺序\n        let [source1, target1] = math.tar.exchangeOrder(source, target);\n        let matrix = math.tar.transform(source1, target1);\n        item.matrix = matrix;\n      });\n    }\n    // 默认图片类型\n    else {\n      let { transform = {} } = displayTarget;\n      let tex = texHash[displayTarget.path || displayTarget.name];\n      let parentBoneMatrix = boneHash[parent].currentMatrix;\n      let matrix = math.matrix.identity();\n      // 图片本身形变，因中心点在图片本身中心，所以无论是否有translate都要平移\n      let t = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, (transform.x || 0) - tex.frameWidth * 0.5, (transform.y || 0) - tex.frameHeight * 0.5, 0, 1];\n      matrix = math.matrix.multiply(matrix, t);\n      // 可选旋转\n      if(transform.skX) {\n        let d = math.geom.d2r(transform.skX);\n        let sin = Math.sin(d);\n        let cos = Math.cos(d);\n        let t = [cos, sin, 0, 0, -sin, cos, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        matrix = math.matrix.multiply(matrix, t);\n      }\n      // 可选缩放\n      if(transform.scX !== undefined || transform.scY !== undefined) {\n        let t = [transform.scX === undefined ? 1 : transform.scX, 0, 0, 0, 0, transform.scY === undefined ? 1 : transform.scY, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        matrix = math.matrix.multiply(matrix, t);\n      }\n      // tfo为图片中心，可合并\n      t = math.matrix.identity();\n      t[12] = tex.frameWidth * 0.5;\n      t[13] = tex.frameHeight * 0.5;\n      matrix = math.matrix.multiply(t, matrix);\n      t = math.matrix.identity();\n      t[12] = -tex.frameWidth * 0.5;\n      t[13] = -tex.frameHeight * 0.5;\n      matrix = math.matrix.multiply(matrix, t);\n      matrix = math.matrix.multiply(parentBoneMatrix, matrix);\n      displayTarget.matrix = matrix;\n    }\n  });\n}\n\nfunction clearAnimation(bone, slot) {\n  bone.forEach(item => {\n    delete item.matrixA;\n  });\n  slot.forEach(item => {\n    delete item.displayIndexA;\n    delete item.colorA;\n  });\n}\n\nexport default {\n  animateBoneMatrix,\n  mergeBoneMatrix,\n  animateSlot,\n  calSlot,\n  clearAnimation,\n};\n","import karas from 'karas';\n\nconst { math } = karas;\n\nfunction canvasBone(ctx, matrixEvent, bone, dx, dy) {\n  let { length, children, currentMatrix } = bone;\n  let m = math.matrix.multiply(matrixEvent, currentMatrix);\n  ctx.setTransform(m[0], m[1], m[4], m[5], m[12], m[13]);\n  ctx.beginPath();\n  ctx.strokeStyle = '#000';\n  ctx.lineWidth = 1;\n  ctx.arc(dx, dy, 5, 0, Math.PI * 2);\n  ctx.moveTo(dx, dy);\n  ctx.lineTo((length || 5) + dx, dy);\n  ctx.closePath();\n  ctx.stroke();\n  children.forEach(item => {\n    canvasBone(ctx, matrixEvent, item, dx, dy);\n  });\n}\n\nfunction canvasSlot(ctx, matrixEvent, slot, skinHash, texHash, dx, dy) {\n  slot.forEach(item => {\n    let { name, displayIndex = 0, displayIndexA = displayIndex, blendMode, color = {}, colorA = color } = item;\n    // 插槽隐藏不显示\n    if(displayIndexA < 0) {\n      return;\n    }\n    // 叠加模式\n    if(blendMode === 'add') {\n      ctx.globalCompositeOperation = 'lighter';\n    }\n    else {\n      ctx.globalCompositeOperation = 'source-over';\n    }\n    let { aM = 100 } = colorA;\n    let opacity = ctx.globalAlpha;\n    // 透明度\n    ctx.globalAlpha *= aM / 100;\n    let skin = skinHash[name];\n    let displayTarget = skin.display[displayIndexA];\n    let tex = texHash[displayTarget.path || displayTarget.name];\n    // 网格类型\n    if(displayTarget.type === 'mesh') {\n      let { triangleList } = displayTarget;\n      triangleList.forEach(item => {\n        let { matrix, scaleCoords } = item;\n        matrix = math.matrix.multiply(matrixEvent, matrix);\n        // clip绘制\n        ctx.save();\n        ctx.setTransform(matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]);\n        ctx.beginPath();\n        ctx.moveTo(scaleCoords[0][0] + dx, scaleCoords[0][1] + dy);\n        ctx.lineTo(scaleCoords[1][0] + dx, scaleCoords[1][1] + dy);\n        ctx.lineTo(scaleCoords[2][0] + dx, scaleCoords[2][1] + dy);\n        ctx.closePath();\n        ctx.clip();\n        ctx.drawImage(tex.source, -tex.x - tex.frameX + dx, -tex.y - tex.frameY + dy);\n        ctx.restore();\n      });\n    }\n    // 默认图片类型\n    else {\n      let { matrix } = displayTarget;\n      if(matrix[0] === 0 || matrix[5] === 0) {\n        return;\n      }\n      matrix = math.matrix.multiply(matrixEvent, matrix);\n      // clip绘制\n      ctx.save();\n      ctx.setTransform(matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]);\n      ctx.beginPath();\n      ctx.moveTo(-tex.frameX + dx, -tex.frameY + dy);\n      ctx.lineTo(-tex.frameX + tex.width + dx, -tex.frameY + dy);\n      ctx.lineTo(-tex.frameX + tex.width + dx,  -tex.frameY + tex.height + dy);\n      ctx.lineTo(-tex.frameX + dx,  -tex.frameY + tex.height + dy);\n      ctx.closePath();\n      ctx.clip();\n      ctx.drawImage(tex.source, -tex.x - tex.frameX + dx, -tex.y - tex.frameY + dy);\n      ctx.restore();\n    }\n    // 恢复模式\n    if(blendMode) {\n      ctx.globalCompositeOperation = 'source-over';\n    }\n    ctx.globalAlpha = opacity;\n  });\n}\n\nfunction canvasTriangle(ctx, matrixEvent, slot, skinHash, texHash, dx, dy) {\n  slot.forEach(item => {\n    let { name, displayIndex = 0, displayIndexA = displayIndex } = item;\n    // 插槽隐藏不显示\n    if(displayIndexA < 0) {\n      return;\n    }\n    let skin = skinHash[name];\n    let displayTarget = skin.display[displayIndexA];\n    let tex = texHash[displayTarget.path || displayTarget.name];\n    // 网格类型\n    if(displayTarget.type === 'mesh') {\n      let { verticesList, triangleList } = displayTarget;\n      triangleList.forEach(item => {\n        let { matrix, scaleCoords } = item;\n        matrix = math.matrix.multiply(matrixEvent, matrix);\n        ctx.setTransform(matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]);\n        ctx.strokeStyle = '#39F';\n        ctx.lineWidth = 1;\n        ctx.beginPath();\n        ctx.moveTo(scaleCoords[0][0] + dx, scaleCoords[0][1] + dy);\n        ctx.lineTo(scaleCoords[1][0] + dx, scaleCoords[1][1] + dy);\n        ctx.lineTo(scaleCoords[2][0] + dx, scaleCoords[2][1] + dy);\n        ctx.closePath();\n        ctx.stroke();\n      });\n      verticesList.forEach(item => {\n        let { matrix, matrixF } = item;\n        matrix = math.matrix.multiply(matrixEvent, matrixF || matrix);\n        ctx.setTransform(matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]);\n        ctx.fillStyle = '#0D6';\n        ctx.beginPath();\n        ctx.arc(dx, dy, 4, 0, Math.PI * 2);\n        ctx.closePath();\n        ctx.fill();\n      });\n    }\n    // 默认图片类型\n    else {\n      let { matrix } = displayTarget;\n      matrix = math.matrix.multiply(matrixEvent, matrix);\n      ctx.save();\n      ctx.setTransform(matrix[0], matrix[1], matrix[4], matrix[5], matrix[12], matrix[13]);\n      ctx.strokeStyle = '#F90';\n      ctx.lineWidth = 1;\n      ctx.beginPath();\n      ctx.moveTo(dx, dy);\n      ctx.lineTo(tex.frameWidth + dx, dy);\n      ctx.lineTo(tex.frameWidth + dx, tex.frameHeight + dy);\n      ctx.lineTo(dx, tex.frameHeight + dy);\n      ctx.closePath();\n      ctx.stroke();\n      ctx.strokeStyle = 'rgba(172, 0, 172, 0.5)';\n      ctx.beginPath();\n      ctx.moveTo(-tex.frameX + dx, -tex.frameY + dy);\n      ctx.lineTo(-tex.frameX + tex.width + dx, -tex.frameY + dy);\n      ctx.lineTo(-tex.frameX + tex.width + dx,  -tex.frameY + tex.height + dy);\n      ctx.lineTo(-tex.frameX + dx,  -tex.frameY + tex.height + dy);\n      ctx.closePath();\n      ctx.stroke();\n      ctx.restore();\n    }\n  });\n}\n\nexport default {\n  canvasSlot,\n  canvasTriangle,\n  canvasBone,\n};\n","import karas from 'karas';\nimport parser from './parser';\nimport util from './util';\nimport render from './render';\nimport { version } from '../package.json';\n\nlet uuid = 0;\n\nconst SHARE_CACHE = {};\nconst { STYLE_KEY: {\n  DISPLAY,\n  VISIBILITY,\n  OPACITY,\n  MARGIN_LEFT,\n  PADDING_LEFT,\n  BORDER_LEFT_WIDTH,\n  MARGIN_TOP,\n  PADDING_TOP,\n  BORDER_TOP_WIDTH,\n  WIDTH,\n  HEIGHT,\n} } = karas.enums;\n\nclass Dragonbones extends karas.Component {\n  componentDidMount() {\n    this.init();\n  }\n\n  shouldComponentUpdate(nextProps) {\n    let props = this.props;\n    if(nextProps !== props) {\n      if(nextProps.ske !== props.ske\n        || nextProps.tex !== props.tex\n        || nextProps.enlarge !== props.enlarge\n        || nextProps.enlargeSlot !== props.enlargeSlot\n          && !karas.util.equal(nextProps.enlargeSlot, props.enlargeSlot)) {\n        this.init();\n      }\n      else {\n        if(nextProps.armature !== props.armature) {\n          this.armature(nextProps.armature, props);\n        }\n        else {\n          if(nextProps.action !== props.action) {\n            this.action(nextProps.action);\n          }\n          if(nextProps.imagePath !== props.imagePath) {\n            this.changeImage(nextProps.imagePath);\n          }\n          if(nextProps.playbackRate !== props.playbackRate && this.animation) {\n            this.animation.playbackRate = nextProps.playbackRate;\n          }\n          if(nextProps.fps !== props.fps && this.animation) {\n            this.animation.fps = nextProps.fps;\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  init() {\n    let props = this.props;\n    let { ske, tex } = props;\n    let total = 0;\n    if(karas.util.isString(ske)) {\n      total++;\n      props.loadJson(ske, (res) => {\n        total--;\n        ske = res;\n        this.build(total, ske, tex);\n      });\n    }\n    if(karas.util.isString(tex)) {\n      total++;\n      props.loadJson(tex, (res) => {\n        total--;\n        tex = res;\n        this.build(total, ske, tex);\n      });\n    }\n    this.build(total, ske, tex);\n  }\n\n  build(count, ske, tex) {\n    if(count !== 0) {\n      return;\n    }\n    let props = this.props;\n    this.staticCacheFlag = !!props.staticCache;\n    this.staticCacheHash = {};\n    ske.uuid = ske.uuid || ++uuid;\n    if(ske.version !== '5.5') {\n      throw new Error('The version' + ske.version + ' does not match 5.5');\n    }\n    this.ske = karas.util.clone(ske);\n    this.tex = karas.util.clone(tex);\n    parser.parseAndLoadTex(this.tex, (texHash) => {\n      this.texHash = texHash;\n      this.armature(props.armature, props);\n    }, props);\n  }\n\n  armature(name, options = {}) {\n    let op = karas.util.extend({}, options);\n    op.armature = name;\n    let {\n      name: n,\n      bone,\n      boneHash,\n      slot,\n      slotHash,\n      skin,\n      skinHash,\n      animationHash,\n      defaultActions,\n      canvas,\n    } = parser.parseSke(this.ske, this.texHash, op);\n    this.armatureName = n;\n    this.bone = bone;\n    this.boneHash = boneHash;\n    this.slot = slot;\n    this.slotHash = slotHash;\n    this.skin = skin;\n    this.skinHash = skinHash;\n    this.animationHash = animationHash;\n    this.canvas = canvas;\n\n    let defaultAction;\n    if(options.action && animationHash[options.action]) {\n      let key = options.pause ? 'gotoAndStop' : 'gotoAndPlay';\n      defaultAction = {\n        [key]: options.action,\n      };\n    }\n    // 不存在或没有指定使用ske文件的第一个\n    else if(defaultActions && defaultActions.length) {\n      defaultAction = defaultActions[0];\n    }\n    if(defaultAction) {\n      let a = this.action(defaultAction.gotoAndPlay || defaultAction.gotoAndStop);\n      if(options.pause || defaultAction.gotoAndStop) {\n        a.gotoAndStop(0);\n      }\n      return a;\n    }\n    else {\n      console.warn('No action data');\n    }\n  }\n\n  action(name) {\n    this.actionName = name;\n    let animation = this.animationHash[name];\n    if(!animation) {\n      throw new Error('Can not find animation: ' + name);\n    }\n    // 清除上次动画的影响\n    if(this.animation) {\n      util.clearAnimation(this.bone, this.slot);\n    }\n    let { boneAnimationList, slotAnimationList, ffdAnimationHash, options } = animation;\n    if(!karas.util.isNil(this.props.playbackRate)) {\n      options.playbackRate = this.props.playbackRate;\n    }\n    if(!karas.util.isNil(this.props.fps)) {\n      options.fps = this.props.fps;\n    }\n    // 隐藏节点模拟一段不展示的动画，带动每次渲染\n    let fake = this.ref.fake;\n    fake.clearAnimate();\n    let a = this.animation = fake.animate([\n      {\n        backgroundColor: '#000',\n      },\n      {\n        backgroundColor: '#FFF',\n      },\n    ], options);\n    // 劫持隐藏节点渲染，因本身display:none可以不执行原本逻辑，计算并渲染骨骼动画\n    let self = this;\n    let computedStyle = self.shadowRoot.computedStyle;\n    let root = self.root;\n    let width = root.width;\n    let height = root.height;\n    fake.render = function(renderMode, ctx, dx = 0, dy = 0) {\n      if(computedStyle[DISPLAY] === 'none'\n        || computedStyle[VISIBILITY] === 'hidden'\n        || computedStyle[OPACITY] === 0) {\n        return;\n      }\n      // 开启了静态帧优化优先使用缓存\n      let offScreen;\n      let sourceCtx;\n      let staticKey;\n      if(self.staticCacheFlag) {\n        offScreen = karas.inject.getCacheCanvas(width, height);\n        sourceCtx = ctx;\n        ctx = offScreen.ctx;\n        let frame = Math.floor(a.currentTime * (self.fps || 60) / 1000);\n        // ske文件uuid + 骨架名 + 动画名 + 帧数\n        staticKey = self.ske.uuid + '>' + self.armatureName + '>' + self.actionName + '>' + frame;\n        let ca = self.staticCacheHash[staticKey];\n        if(ca) {\n          ctx.putImageData(ca, 0, 0);\n          offScreen.draw(ctx);\n          sourceCtx.drawImage(offScreen.canvas, 0, 0);\n          ctx.clearRect(0, 0, width, height);\n          return;\n        }\n      }\n      let { bone, slot, boneHash, slotHash, skinHash, texHash } = self;\n      // 动态情况缓存当前帧，为多个实例节省计算\n      let dynamicKey = self.ske.uuid + '>' + self.armatureName + '>' + self.actionName;\n      let dynamicCache = SHARE_CACHE[dynamicKey];\n      if(self.props.share && dynamicCache && dynamicCache.currentTime === a.currentTime) {\n        bone = dynamicCache.bone;\n        slot = dynamicCache.slot;\n        skinHash = dynamicCache.skinHash;\n      }\n      else {\n        let offset = Math.min(1, a.currentTime / a.duration);\n        util.animateBoneMatrix(boneAnimationList, offset, boneHash);\n        util.mergeBoneMatrix(bone[0]);\n        util.animateSlot(slotAnimationList, offset, slotHash);\n        util.calSlot(offset, slot, skinHash, bone, boneHash, texHash, ffdAnimationHash);\n        SHARE_CACHE[dynamicKey] = {\n          bone,\n          slot,\n          skinHash,\n          currentTime: a.currentTime,\n        };\n      }\n      if(renderMode === karas.mode.CANVAS) {\n        let { matrixEvent } = self.shadowRoot;\n        // 先在dom中居中\n        let left = computedStyle[MARGIN_LEFT] + computedStyle[BORDER_LEFT_WIDTH] + computedStyle[PADDING_LEFT] + computedStyle[WIDTH] * 0.5;\n        let top = computedStyle[MARGIN_TOP] + computedStyle[BORDER_TOP_WIDTH] + computedStyle[PADDING_TOP] + computedStyle[HEIGHT] * 0.5;\n        let t = karas.math.matrix.identity();\n        t[12] = left;\n        t[13] = top;\n        // 画布居中\n        if(self.canvas) {\n          let dx = self.canvas.x || 0;\n          let dy = self.canvas.y || 0;\n          t[12] -= dx * 0.5;\n          t[13] -= dy * 0.5;\n          // 适配尺寸\n          if(self.props.fitSize) {\n            let sx = computedStyle.width / self.canvas.width;\n            let sy = computedStyle.height / self.canvas.height;\n            t[0] = sx;\n            t[5] = sy;\n          }\n        }\n        matrixEvent = karas.math.matrix.multiply(matrixEvent, t);\n        render.canvasSlot(ctx, matrixEvent, slot, skinHash, texHash, dx, dy);\n        // debug模式\n        if(self.props.debug) {\n          render.canvasTriangle(ctx, matrixEvent, slot, skinHash, texHash, dx, dy);\n          render.canvasBone(ctx, matrixEvent, bone[0], dx, dy);\n        }\n        else {\n          if(self.props.debugBone) {\n            render.canvasBone(ctx, matrixEvent, bone[0], dx, dy);\n          }\n          if(self.props.debugSlot) {\n            render.canvasTriangle(ctx, matrixEvent, slot, skinHash, texHash, dx, dy);\n          }\n        }\n        // 静态帧优化将离屏内容绘入\n        if(self.staticCacheFlag) {\n          offScreen.draw(ctx);\n          sourceCtx.drawImage(offScreen.canvas, 0, 0);\n          self.staticCacheHash[staticKey] = ctx.getImageData(0, 0, width, height);\n          ctx.clearRect(0, 0, width, height);\n        }\n      }\n    };\n    return a;\n  }\n\n  changeImage(src) {\n    if(src) {\n      let tex = this.tex;\n      tex.imagePath = src;\n      let texHash = this.texHash;\n      karas.inject.measureImg(src, function() {\n        tex.SubTexture.forEach(item => {\n          let { name } = item;\n          texHash[name].source = karas.inject.IMG[src].source;\n        });\n      });\n    }\n  }\n\n  setStaticCache(flag) {\n    this.staticCacheFlag = !!flag;\n  }\n\n  cleanStaticCache() {\n    this.staticCacheHash = {};\n  }\n\n  render() {\n    return <div>\n      <$polyline ref=\"fake\"/>\n    </div>;\n  }\n}\n\nDragonbones.version = version;\n\nexport default Dragonbones;\n"],"names":["inject","karas","math","parseAndLoadTex","tex","cb","props","src","imagePath","texHash","measureImg","SubTexture","forEach","item","name","x","y","width","height","frameX","frameY","frameWidth","frameHeight","source","IMG","parseSke","ske","globalFrameRate","frameRate","armature","currentArmature","i","len","length","Error","console","warn","bone","slot","skin","animation","defaultActions","canvas","boneHash","parseBone","slotHash","parseSlot","skinHash","parseSkin","animationHash","parseAnimation","data","hash","root","children","parent","transform","push","index","matrix","identity","m","multiply","skX","d","geom","d2r","sin","Math","cos","scX","undefined","scY","slotName","display","type","path","vertices","triangles","uvs","weights","bonePose","weightHash","bonePoseHash","verticesIndex","num","list","j","value","slice","coords","calPoint","pose","verticesList","res","weightList","weight","x0","y0","x1","y1","dx","dy","theta","atan","abs","PI","rotate","translate","triangleList","i1","i2","i3","p1x","p1y","p2x","p2y","p3x","p3y","x2","y2","x3","y3","triangleIncentre","px","parseFloat","enlarge","isNaN","enlargeSlot","hasOwnProperty","n","scale","triangleScale","t","sx1","sy1","sx2","sy2","sx3","sy3","round","indexList","scaleCoords","a","b","c","sqrt","pow","duration","playTimes","ffd","options","iterations","Infinity","fill","boneAnimationList","map","translateFrame","rotateFrame","scaleFrame","originTransform","offsetSum","last","frame","easingFn","getEasing","offset","translateX","translateY","rotateZ","dz","scaleX","scaleY","slotAnimationList","displayFrame","colorFrame","aM","da","ffdAnimationHash","ffdAnimationList","os","unshift","verticesLast","dv","max","curve","animate","easing","cubicBezier","animateBoneMatrix","animationList","frames","binarySearch","current","next","total","percent","matrixA","middle","min","mergeBoneMatrix","currentMatrix","mergeChildBoneMatrix","parentMatrix","animateSlot","displayIndexA","colorA","calSlot","displayIndex","displayTarget","boneMatrix","parentBoneMatrix","offsetMatrix","matrixF","target","concat","tar","exchangeOrder","source1","target1","clearAnimation","canvasBone","ctx","matrixEvent","setTransform","beginPath","strokeStyle","lineWidth","arc","moveTo","lineTo","closePath","stroke","canvasSlot","blendMode","color","globalCompositeOperation","opacity","globalAlpha","save","clip","drawImage","restore","canvasTriangle","fillStyle","uuid","SHARE_CACHE","enums","STYLE_KEY","DISPLAY","VISIBILITY","OPACITY","MARGIN_LEFT","PADDING_LEFT","BORDER_LEFT_WIDTH","MARGIN_TOP","PADDING_TOP","BORDER_TOP_WIDTH","WIDTH","HEIGHT","Dragonbones","init","nextProps","util","equal","action","changeImage","playbackRate","fps","isString","loadJson","build","count","staticCacheFlag","staticCache","staticCacheHash","version","clone","parser","op","extend","armatureName","defaultAction","key","pause","gotoAndPlay","gotoAndStop","actionName","isNil","fake","ref","clearAnimate","backgroundColor","self","computedStyle","shadowRoot","render","renderMode","offScreen","sourceCtx","staticKey","getCacheCanvas","floor","currentTime","ca","putImageData","draw","clearRect","dynamicKey","dynamicCache","share","mode","CANVAS","left","top","fitSize","sx","sy","debug","debugBone","debugSlot","getImageData","flag","Component"],"mappings":"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"}